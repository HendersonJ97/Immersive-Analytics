<!DOCTYPE html>
<meta charset="utf-8">
<head>
  <script src="https://d3js.org/d3.v3.min.js"></script>
  <script src="https://aframe.io/releases/0.6.1/aframe.min.js"></script>
</head>
<body style='margin : 0px; overflow: hidden;'>

  <script>
    var margin = {
        top: 30,
        right: 10,
        bottom: 10,
        left: 10
      },
      width = 960 - margin.left - margin.right,
      height = 500 - margin.top - margin.bottom;

    var x = d3.scale.ordinal()
      .rangePoints([0, width], 1),
      y = {},
      dragging = {};

    var line = d3.svg.line();
    var background, foreground;

    d3.csv("cars.csv", function(cars) {

      x.domain(dimensions = d3.keys(cars[0]) // get column names (leaving as global)
        .filter(function(column_name) {
          return column_name != "name" && (y[column_name] = d3.scale.linear() // Discard names
            .domain(d3.extent(cars, function(max_values) { // create scale from max column values
              return +max_values[column_name]
            }))
            .range([height, 0]))
        }));
      //scene.append("a-camera");
      var lines = d3.select("a-scene").selectAll("a-entity")
        .data(cars)
        .enter()
        .append("a-entity")
        .each(function(datum, index) {
          // Select itself
          var entity = d3.select(this);
          var coordinates = dimensions.map(function(column_name) {
            return [x(column_name), y[column_name](datum[column_name])];
          });
          console.log("coords", coordinates);
          // Loop for each dimension
          for (i = 0; i < coordinates.length - 1; i++) {
            var value = "start: " + coordinates[i][0] + " " + coordinates[i][1] +
              " 0; end: " + coordinates[i + 1][0] + " " + coordinates[i + 1][1] +
              " 0; color: red";
            entity.attr("line__" + (i + 1), value);
          }
        })

    })
  </script>
  <a-scene>
    <a-entity camera></a-entity>
  </a-scene>
</body>
</html>
